.include "macros.inc"
.section .text, "ax"  # 0x80005560 - 0x80221F60
.global CreateCallbackFat
CreateCallbackFat:
/* 8020BEE8 00208E48  7C 08 02 A6 */	mflr r0
/* 8020BEEC 00208E4C  90 01 00 04 */	stw r0, 4(r1)
/* 8020BEF0 00208E50  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 8020BEF4 00208E54  BF 61 00 14 */	stmw r27, 0x14(r1)
/* 8020BEF8 00208E58  3B 83 00 00 */	addi r28, r3, 0
/* 8020BEFC 00208E5C  3C 60 80 3D */	lis r3, __CARDBlock@ha
/* 8020BF00 00208E60  1C BC 01 08 */	mulli r5, r28, 0x108
/* 8020BF04 00208E64  38 03 34 20 */	addi r0, r3, __CARDBlock@l
/* 8020BF08 00208E68  7F E0 2A 14 */	add r31, r0, r5
/* 8020BF0C 00208E6C  83 BF 00 D0 */	lwz r29, 0xd0(r31)
/* 8020BF10 00208E70  3B 60 00 00 */	li r27, 0
/* 8020BF14 00208E74  7C 9E 23 79 */	or. r30, r4, r4
/* 8020BF18 00208E78  93 7F 00 D0 */	stw r27, 0xd0(r31)
/* 8020BF1C 00208E7C  41 80 00 C0 */	blt .L_8020BFDC
/* 8020BF20 00208E80  7F E3 FB 78 */	mr r3, r31
/* 8020BF24 00208E84  4B FF D9 8D */	bl __CARDGetDirBlock
/* 8020BF28 00208E88  A0 1F 00 BC */	lhz r0, 0xbc(r31)
/* 8020BF2C 00208E8C  38 A0 00 04 */	li r5, 4
/* 8020BF30 00208E90  80 8D 34 08 */	lwz r4, __CARDDiskID@sda21(r13)
/* 8020BF34 00208E94  54 00 30 32 */	slwi r0, r0, 6
/* 8020BF38 00208E98  7F C3 02 14 */	add r30, r3, r0
/* 8020BF3C 00208E9C  38 7E 00 00 */	addi r3, r30, 0
/* 8020BF40 00208EA0  4B DF 74 D5 */	bl memcpy
/* 8020BF44 00208EA4  80 8D 34 08 */	lwz r4, __CARDDiskID@sda21(r13)
/* 8020BF48 00208EA8  38 7E 00 04 */	addi r3, r30, 4
/* 8020BF4C 00208EAC  38 A0 00 02 */	li r5, 2
/* 8020BF50 00208EB0  38 84 00 04 */	addi r4, r4, 4
/* 8020BF54 00208EB4  4B DF 74 C1 */	bl memcpy
/* 8020BF58 00208EB8  38 00 00 04 */	li r0, 4
/* 8020BF5C 00208EBC  98 1E 00 34 */	stb r0, 0x34(r30)
/* 8020BF60 00208EC0  38 00 FF FF */	li r0, -1
/* 8020BF64 00208EC4  3C 60 80 00 */	lis r3, 0x800000F8@ha
/* 8020BF68 00208EC8  9B 7E 00 35 */	stb r27, 0x35(r30)
/* 8020BF6C 00208ECC  A0 9F 00 BE */	lhz r4, 0xbe(r31)
/* 8020BF70 00208ED0  B0 9E 00 36 */	sth r4, 0x36(r30)
/* 8020BF74 00208ED4  9B 7E 00 07 */	stb r27, 7(r30)
/* 8020BF78 00208ED8  90 1E 00 2C */	stw r0, 0x2c(r30)
/* 8020BF7C 00208EDC  B3 7E 00 30 */	sth r27, 0x30(r30)
/* 8020BF80 00208EE0  B3 7E 00 32 */	sth r27, 0x32(r30)
/* 8020BF84 00208EE4  90 1E 00 3C */	stw r0, 0x3c(r30)
/* 8020BF88 00208EE8  A0 1E 00 32 */	lhz r0, 0x32(r30)
/* 8020BF8C 00208EEC  54 00 00 3A */	rlwinm r0, r0, 0, 0, 0x1d
/* 8020BF90 00208EF0  60 00 00 01 */	ori r0, r0, 1
/* 8020BF94 00208EF4  B0 1E 00 32 */	sth r0, 0x32(r30)
/* 8020BF98 00208EF8  80 9F 00 C0 */	lwz r4, 0xc0(r31)
/* 8020BF9C 00208EFC  93 64 00 08 */	stw r27, 8(r4)
/* 8020BFA0 00208F00  A0 1E 00 36 */	lhz r0, 0x36(r30)
/* 8020BFA4 00208F04  80 9F 00 C0 */	lwz r4, 0xc0(r31)
/* 8020BFA8 00208F08  B0 04 00 10 */	sth r0, 0x10(r4)
/* 8020BFAC 00208F0C  80 03 00 F8 */	lwz r0, 0x800000F8@l(r3)
/* 8020BFB0 00208F10  54 1B F0 BE */	srwi r27, r0, 2
/* 8020BFB4 00208F14  4B FF 13 ED */	bl OSGetTime
/* 8020BFB8 00208F18  38 DB 00 00 */	addi r6, r27, 0
/* 8020BFBC 00208F1C  38 A0 00 00 */	li r5, 0
/* 8020BFC0 00208F20  48 00 8F E9 */	bl __div2i
/* 8020BFC4 00208F24  90 9E 00 28 */	stw r4, 0x28(r30)
/* 8020BFC8 00208F28  38 7C 00 00 */	addi r3, r28, 0
/* 8020BFCC 00208F2C  38 9D 00 00 */	addi r4, r29, 0
/* 8020BFD0 00208F30  4B FF DA 81 */	bl __CARDUpdateDir
/* 8020BFD4 00208F34  7C 7E 1B 79 */	or. r30, r3, r3
/* 8020BFD8 00208F38  40 80 00 2C */	bge .L_8020C004
.L_8020BFDC:
/* 8020BFDC 00208F3C  38 7F 00 00 */	addi r3, r31, 0
/* 8020BFE0 00208F40  38 9E 00 00 */	addi r4, r30, 0
/* 8020BFE4 00208F44  4B FF CF 3D */	bl __CARDPutControlBlock
/* 8020BFE8 00208F48  28 1D 00 00 */	cmplwi r29, 0
/* 8020BFEC 00208F4C  41 82 00 18 */	beq .L_8020C004
/* 8020BFF0 00208F50  39 9D 00 00 */	addi r12, r29, 0
/* 8020BFF4 00208F54  7D 88 03 A6 */	mtlr r12
/* 8020BFF8 00208F58  38 7C 00 00 */	addi r3, r28, 0
/* 8020BFFC 00208F5C  38 9E 00 00 */	addi r4, r30, 0
/* 8020C000 00208F60  4E 80 00 21 */	blrl 
.L_8020C004:
/* 8020C004 00208F64  BB 61 00 14 */	lmw r27, 0x14(r1)
/* 8020C008 00208F68  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 8020C00C 00208F6C  38 21 00 28 */	addi r1, r1, 0x28
/* 8020C010 00208F70  7C 08 03 A6 */	mtlr r0
/* 8020C014 00208F74  4E 80 00 20 */	blr 

.global CARDCreateAsync
CARDCreateAsync:
/* 8020C018 00208F78  7C 08 02 A6 */	mflr r0
/* 8020C01C 00208F7C  90 01 00 04 */	stw r0, 4(r1)
/* 8020C020 00208F80  94 21 FF B8 */	stwu r1, -0x48(r1)
/* 8020C024 00208F84  BE E1 00 24 */	stmw r23, 0x24(r1)
/* 8020C028 00208F88  3B 44 00 00 */	addi r26, r4, 0
/* 8020C02C 00208F8C  3B 23 00 00 */	addi r25, r3, 0
/* 8020C030 00208F90  3B 65 00 00 */	addi r27, r5, 0
/* 8020C034 00208F94  3B 86 00 00 */	addi r28, r6, 0
/* 8020C038 00208F98  3B A7 00 00 */	addi r29, r7, 0
/* 8020C03C 00208F9C  38 7A 00 00 */	addi r3, r26, 0
/* 8020C040 00208FA0  48 00 D3 CD */	bl strlen
/* 8020C044 00208FA4  28 03 00 20 */	cmplwi r3, 0x20
/* 8020C048 00208FA8  40 81 00 0C */	ble .L_8020C054
/* 8020C04C 00208FAC  38 60 FF F4 */	li r3, -12
/* 8020C050 00208FB0  48 00 01 CC */	b .L_8020C21C
.L_8020C054:
/* 8020C054 00208FB4  38 79 00 00 */	addi r3, r25, 0
/* 8020C058 00208FB8  38 81 00 1C */	addi r4, r1, 0x1c
/* 8020C05C 00208FBC  4B FF CE 15 */	bl __CARDGetControlBlock
/* 8020C060 00208FC0  2C 03 00 00 */	cmpwi r3, 0
/* 8020C064 00208FC4  40 80 00 08 */	bge .L_8020C06C
/* 8020C068 00208FC8  48 00 01 B4 */	b .L_8020C21C
.L_8020C06C:
/* 8020C06C 00208FCC  28 1B 00 00 */	cmplwi r27, 0
/* 8020C070 00208FD0  41 82 00 1C */	beq .L_8020C08C
/* 8020C074 00208FD4  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 8020C078 00208FD8  80 83 00 0C */	lwz r4, 0xc(r3)
/* 8020C07C 00208FDC  7C 1B 23 96 */	divwu r0, r27, r4
/* 8020C080 00208FE0  7C 00 21 D6 */	mullw r0, r0, r4
/* 8020C084 00208FE4  7C 00 D8 51 */	subf. r0, r0, r27
/* 8020C088 00208FE8  41 82 00 0C */	beq .L_8020C094
.L_8020C08C:
/* 8020C08C 00208FEC  38 60 FF 80 */	li r3, -128
/* 8020C090 00208FF0  48 00 01 8C */	b .L_8020C21C
.L_8020C094:
/* 8020C094 00208FF4  3C 80 00 01 */	lis r4, 0x0000FFFF@ha
/* 8020C098 00208FF8  3B C4 FF FF */	addi r30, r4, 0x0000FFFF@l
/* 8020C09C 00208FFC  4B FF D8 15 */	bl __CARDGetDirBlock
/* 8020C0A0 00209000  3B E3 00 00 */	addi r31, r3, 0
/* 8020C0A4 00209004  3B 1F 00 00 */	addi r24, r31, 0
/* 8020C0A8 00209008  3A E0 00 00 */	li r23, 0
/* 8020C0AC 0020900C  48 00 00 84 */	b .L_8020C130
.L_8020C0B0:
/* 8020C0B0 00209010  88 18 00 00 */	lbz r0, 0(r24)
/* 8020C0B4 00209014  28 00 00 FF */	cmplwi r0, 0xff
/* 8020C0B8 00209018  40 82 00 18 */	bne .L_8020C0D0
/* 8020C0BC 0020901C  57 C0 04 3E */	clrlwi r0, r30, 0x10
/* 8020C0C0 00209020  28 00 FF FF */	cmplwi r0, 0xffff
/* 8020C0C4 00209024  40 82 00 64 */	bne .L_8020C128
/* 8020C0C8 00209028  7E FE BB 78 */	mr r30, r23
/* 8020C0CC 0020902C  48 00 00 5C */	b .L_8020C128
.L_8020C0D0:
/* 8020C0D0 00209030  80 8D 34 08 */	lwz r4, __CARDDiskID@sda21(r13)
/* 8020C0D4 00209034  38 78 00 00 */	addi r3, r24, 0
/* 8020C0D8 00209038  38 A0 00 04 */	li r5, 4
/* 8020C0DC 0020903C  48 00 A0 91 */	bl memcmp
/* 8020C0E0 00209040  2C 03 00 00 */	cmpwi r3, 0
/* 8020C0E4 00209044  40 82 00 44 */	bne .L_8020C128
/* 8020C0E8 00209048  80 8D 34 08 */	lwz r4, __CARDDiskID@sda21(r13)
/* 8020C0EC 0020904C  38 78 00 04 */	addi r3, r24, 4
/* 8020C0F0 00209050  38 A0 00 02 */	li r5, 2
/* 8020C0F4 00209054  38 84 00 04 */	addi r4, r4, 4
/* 8020C0F8 00209058  48 00 A0 75 */	bl memcmp
/* 8020C0FC 0020905C  2C 03 00 00 */	cmpwi r3, 0
/* 8020C100 00209060  40 82 00 28 */	bne .L_8020C128
/* 8020C104 00209064  38 78 00 00 */	addi r3, r24, 0
/* 8020C108 00209068  38 9A 00 00 */	addi r4, r26, 0
/* 8020C10C 0020906C  4B FF F9 75 */	bl __CARDCompareFileName
/* 8020C110 00209070  2C 03 00 00 */	cmpwi r3, 0
/* 8020C114 00209074  41 82 00 14 */	beq .L_8020C128
/* 8020C118 00209078  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 8020C11C 0020907C  38 80 FF F9 */	li r4, -7
/* 8020C120 00209080  4B FF CE 01 */	bl __CARDPutControlBlock
/* 8020C124 00209084  48 00 00 F8 */	b .L_8020C21C
.L_8020C128:
/* 8020C128 00209088  3B 18 00 40 */	addi r24, r24, 0x40
/* 8020C12C 0020908C  3A F7 00 01 */	addi r23, r23, 1
.L_8020C130:
/* 8020C130 00209090  56 E0 04 3E */	clrlwi r0, r23, 0x10
/* 8020C134 00209094  28 00 00 7F */	cmplwi r0, 0x7f
/* 8020C138 00209098  41 80 FF 78 */	blt .L_8020C0B0
/* 8020C13C 0020909C  57 C0 04 3E */	clrlwi r0, r30, 0x10
/* 8020C140 002090A0  28 00 FF FF */	cmplwi r0, 0xffff
/* 8020C144 002090A4  40 82 00 14 */	bne .L_8020C158
/* 8020C148 002090A8  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 8020C14C 002090AC  38 80 FF F8 */	li r4, -8
/* 8020C150 002090B0  4B FF CD D1 */	bl __CARDPutControlBlock
/* 8020C154 002090B4  48 00 00 C8 */	b .L_8020C21C
.L_8020C158:
/* 8020C158 002090B8  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 8020C15C 002090BC  4B FF D3 51 */	bl __CARDGetFatBlock
/* 8020C160 002090C0  80 81 00 1C */	lwz r4, 0x1c(r1)
/* 8020C164 002090C4  A0 03 00 06 */	lhz r0, 6(r3)
/* 8020C168 002090C8  80 64 00 0C */	lwz r3, 0xc(r4)
/* 8020C16C 002090CC  7C 03 01 D6 */	mullw r0, r3, r0
/* 8020C170 002090D0  7C 00 D8 40 */	cmplw r0, r27
/* 8020C174 002090D4  40 80 00 14 */	bge .L_8020C188
/* 8020C178 002090D8  38 64 00 00 */	addi r3, r4, 0
/* 8020C17C 002090DC  38 80 FF F7 */	li r4, -9
/* 8020C180 002090E0  4B FF CD A1 */	bl __CARDPutControlBlock
/* 8020C184 002090E4  48 00 00 98 */	b .L_8020C21C
.L_8020C188:
/* 8020C188 002090E8  28 1D 00 00 */	cmplwi r29, 0
/* 8020C18C 002090EC  41 82 00 0C */	beq .L_8020C198
/* 8020C190 002090F0  7F A0 EB 78 */	mr r0, r29
/* 8020C194 002090F4  48 00 00 0C */	b .L_8020C1A0
.L_8020C198:
/* 8020C198 002090F8  3C 60 80 20 */	lis r3, __CARDDefaultApiCallback@ha
/* 8020C19C 002090FC  38 03 7E 60 */	addi r0, r3, __CARDDefaultApiCallback@l
.L_8020C1A0:
/* 8020C1A0 00209100  90 04 00 D0 */	stw r0, 0xd0(r4)
/* 8020C1A4 00209104  57 C0 32 B2 */	rlwinm r0, r30, 6, 0xa, 0x19
/* 8020C1A8 00209108  7C FF 02 14 */	add r7, r31, r0
/* 8020C1AC 0020910C  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 8020C1B0 00209110  57 DD 04 3E */	clrlwi r29, r30, 0x10
/* 8020C1B4 00209114  38 9A 00 00 */	addi r4, r26, 0
/* 8020C1B8 00209118  B3 C3 00 BC */	sth r30, 0xbc(r3)
/* 8020C1BC 0020911C  38 67 00 08 */	addi r3, r7, 8
/* 8020C1C0 00209120  38 A0 00 20 */	li r5, 0x20
/* 8020C1C4 00209124  80 C1 00 1C */	lwz r6, 0x1c(r1)
/* 8020C1C8 00209128  80 06 00 0C */	lwz r0, 0xc(r6)
/* 8020C1CC 0020912C  7C 1B 03 96 */	divwu r0, r27, r0
/* 8020C1D0 00209130  B0 07 00 38 */	sth r0, 0x38(r7)
/* 8020C1D4 00209134  48 00 D1 41 */	bl strncpy
/* 8020C1D8 00209138  80 81 00 1C */	lwz r4, 0x1c(r1)
/* 8020C1DC 0020913C  3C 60 80 21 */	lis r3, CreateCallbackFat@ha
/* 8020C1E0 00209140  38 A3 BE E8 */	addi r5, r3, CreateCallbackFat@l
/* 8020C1E4 00209144  93 84 00 C0 */	stw r28, 0xc0(r4)
/* 8020C1E8 00209148  7F 23 CB 78 */	mr r3, r25
/* 8020C1EC 0020914C  93 3C 00 00 */	stw r25, 0(r28)
/* 8020C1F0 00209150  93 BC 00 04 */	stw r29, 4(r28)
/* 8020C1F4 00209154  80 81 00 1C */	lwz r4, 0x1c(r1)
/* 8020C1F8 00209158  80 04 00 0C */	lwz r0, 0xc(r4)
/* 8020C1FC 0020915C  7C 9B 03 96 */	divwu r4, r27, r0
/* 8020C200 00209160  4B FF D4 51 */	bl __CARDAllocBlock
/* 8020C204 00209164  7C 64 1B 79 */	or. r4, r3, r3
/* 8020C208 00209168  40 80 00 10 */	bge .L_8020C218
/* 8020C20C 0020916C  80 61 00 1C */	lwz r3, 0x1c(r1)
/* 8020C210 00209170  4B FF CD 11 */	bl __CARDPutControlBlock
/* 8020C214 00209174  48 00 00 08 */	b .L_8020C21C
.L_8020C218:
/* 8020C218 00209178  7C 83 23 78 */	mr r3, r4
.L_8020C21C:
/* 8020C21C 0020917C  BA E1 00 24 */	lmw r23, 0x24(r1)
/* 8020C220 00209180  80 01 00 4C */	lwz r0, 0x4c(r1)
/* 8020C224 00209184  38 21 00 48 */	addi r1, r1, 0x48
/* 8020C228 00209188  7C 08 03 A6 */	mtlr r0
/* 8020C22C 0020918C  4E 80 00 20 */	blr 

.global CARDCreate
CARDCreate:
/* 8020C230 00209190  7C 08 02 A6 */	mflr r0
/* 8020C234 00209194  3C E0 80 20 */	lis r7, __CARDSyncCallback@ha
/* 8020C238 00209198  90 01 00 04 */	stw r0, 4(r1)
/* 8020C23C 0020919C  38 E7 7E 64 */	addi r7, r7, __CARDSyncCallback@l
/* 8020C240 002091A0  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8020C244 002091A4  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 8020C248 002091A8  3B E3 00 00 */	addi r31, r3, 0
/* 8020C24C 002091AC  4B FF FD CD */	bl CARDCreateAsync
/* 8020C250 002091B0  2C 03 00 00 */	cmpwi r3, 0
/* 8020C254 002091B4  40 80 00 08 */	bge .L_8020C25C
/* 8020C258 002091B8  48 00 00 0C */	b .L_8020C264
.L_8020C25C:
/* 8020C25C 002091BC  7F E3 FB 78 */	mr r3, r31
/* 8020C260 002091C0  4B FF CE CD */	bl __CARDSync
.L_8020C264:
/* 8020C264 002091C4  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8020C268 002091C8  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 8020C26C 002091CC  38 21 00 20 */	addi r1, r1, 0x20
/* 8020C270 002091D0  7C 08 03 A6 */	mtlr r0
/* 8020C274 002091D4  4E 80 00 20 */	blr 
