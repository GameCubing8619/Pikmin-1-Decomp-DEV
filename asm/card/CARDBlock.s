.include "macros.inc"
.section .text, "ax"  # 0x80005560 - 0x80221F60
.global __CARDGetFatBlock
__CARDGetFatBlock:
/* 802094AC 0020640C  80 63 00 88 */	lwz r3, 0x88(r3)
/* 802094B0 00206410  4E 80 00 20 */	blr 

WriteCallback:
/* 802094B4 00206414  7C 08 02 A6 */	mflr r0
/* 802094B8 00206418  90 01 00 04 */	stw r0, 4(r1)
/* 802094BC 0020641C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 802094C0 00206420  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 802094C4 00206424  93 C1 00 18 */	stw r30, 0x18(r1)
/* 802094C8 00206428  7C 9E 23 79 */	or. r30, r4, r4
/* 802094CC 0020642C  93 A1 00 14 */	stw r29, 0x14(r1)
/* 802094D0 00206430  3B A3 00 00 */	addi r29, r3, 0
/* 802094D4 00206434  1C BD 01 08 */	mulli r5, r29, 0x108
/* 802094D8 00206438  3C 60 80 3D */	lis r3, __CARDBlock@ha
/* 802094DC 0020643C  38 03 34 20 */	addi r0, r3, __CARDBlock@l
/* 802094E0 00206440  7F E0 2A 14 */	add r31, r0, r5
/* 802094E4 00206444  41 80 00 48 */	blt lbl_8020952C
/* 802094E8 00206448  80 7F 00 80 */	lwz r3, 0x80(r31)
/* 802094EC 0020644C  80 1F 00 88 */	lwz r0, 0x88(r31)
/* 802094F0 00206450  38 83 60 00 */	addi r4, r3, 0x6000
/* 802094F4 00206454  7C 00 20 40 */	cmplw r0, r4
/* 802094F8 00206458  3C A3 00 01 */	addis r5, r3, 1
/* 802094FC 0020645C  38 A5 80 00 */	addi r5, r5, -32768
/* 80209500 00206460  40 82 00 18 */	bne lbl_80209518
/* 80209504 00206464  90 BF 00 88 */	stw r5, 0x88(r31)
/* 80209508 00206468  38 65 00 00 */	addi r3, r5, 0
/* 8020950C 0020646C  38 A0 20 00 */	li r5, 0x2000
/* 80209510 00206470  4B DF 9F 05 */	bl memcpy
/* 80209514 00206474  48 00 00 18 */	b lbl_8020952C
lbl_80209518:
/* 80209518 00206478  90 9F 00 88 */	stw r4, 0x88(r31)
/* 8020951C 0020647C  38 64 00 00 */	addi r3, r4, 0
/* 80209520 00206480  38 85 00 00 */	addi r4, r5, 0
/* 80209524 00206484  38 A0 20 00 */	li r5, 0x2000
/* 80209528 00206488  4B DF 9E ED */	bl memcpy
lbl_8020952C:
/* 8020952C 0020648C  80 1F 00 D0 */	lwz r0, 0xd0(r31)
/* 80209530 00206490  28 00 00 00 */	cmplwi r0, 0
/* 80209534 00206494  40 82 00 10 */	bne lbl_80209544
/* 80209538 00206498  38 7F 00 00 */	addi r3, r31, 0
/* 8020953C 0020649C  38 9E 00 00 */	addi r4, r30, 0
/* 80209540 002064A0  4B FF F9 E1 */	bl __CARDPutControlBlock
lbl_80209544:
/* 80209544 002064A4  80 1F 00 D8 */	lwz r0, 0xd8(r31)
/* 80209548 002064A8  28 00 00 00 */	cmplwi r0, 0
/* 8020954C 002064AC  7C 0C 03 78 */	mr r12, r0
/* 80209550 002064B0  41 82 00 1C */	beq lbl_8020956C
/* 80209554 002064B4  38 00 00 00 */	li r0, 0
/* 80209558 002064B8  7D 88 03 A6 */	mtlr r12
/* 8020955C 002064BC  90 1F 00 D8 */	stw r0, 0xd8(r31)
/* 80209560 002064C0  38 7D 00 00 */	addi r3, r29, 0
/* 80209564 002064C4  38 9E 00 00 */	addi r4, r30, 0
/* 80209568 002064C8  4E 80 00 21 */	blrl 
lbl_8020956C:
/* 8020956C 002064CC  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80209570 002064D0  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80209574 002064D4  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 80209578 002064D8  7C 08 03 A6 */	mtlr r0
/* 8020957C 002064DC  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 80209580 002064E0  38 21 00 20 */	addi r1, r1, 0x20
/* 80209584 002064E4  4E 80 00 20 */	blr 

EraseCallback:
/* 80209588 002064E8  7C 08 02 A6 */	mflr r0
/* 8020958C 002064EC  90 01 00 04 */	stw r0, 4(r1)
/* 80209590 002064F0  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 80209594 002064F4  93 E1 00 24 */	stw r31, 0x24(r1)
/* 80209598 002064F8  3B E3 00 00 */	addi r31, r3, 0
/* 8020959C 002064FC  3C 60 80 3D */	lis r3, __CARDBlock@ha
/* 802095A0 00206500  93 C1 00 20 */	stw r30, 0x20(r1)
/* 802095A4 00206504  1C BF 01 08 */	mulli r5, r31, 0x108
/* 802095A8 00206508  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 802095AC 0020650C  38 03 34 20 */	addi r0, r3, __CARDBlock@l
/* 802095B0 00206510  7C 9D 23 79 */	or. r29, r4, r4
/* 802095B4 00206514  7F C0 2A 14 */	add r30, r0, r5
/* 802095B8 00206518  41 80 00 3C */	blt lbl_802095F4
/* 802095BC 0020651C  80 BE 00 88 */	lwz r5, 0x88(r30)
/* 802095C0 00206520  3C 60 80 21 */	lis r3, WriteCallback@ha
/* 802095C4 00206524  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 802095C8 00206528  38 E3 94 B4 */	addi r7, r3, WriteCallback@l
/* 802095CC 0020652C  80 7E 00 0C */	lwz r3, 0xc(r30)
/* 802095D0 00206530  7C 00 28 50 */	subf r0, r0, r5
/* 802095D4 00206534  54 00 9B 7E */	srwi r0, r0, 0xd
/* 802095D8 00206538  7C 83 01 D6 */	mullw r4, r3, r0
/* 802095DC 0020653C  38 C5 00 00 */	addi r6, r5, 0
/* 802095E0 00206540  38 7F 00 00 */	addi r3, r31, 0
/* 802095E4 00206544  38 A0 20 00 */	li r5, 0x2000
/* 802095E8 00206548  4B FF FE 49 */	bl __CARDWrite
/* 802095EC 0020654C  7C 7D 1B 79 */	or. r29, r3, r3
/* 802095F0 00206550  40 80 00 44 */	bge lbl_80209634
lbl_802095F4:
/* 802095F4 00206554  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 802095F8 00206558  28 00 00 00 */	cmplwi r0, 0
/* 802095FC 0020655C  40 82 00 10 */	bne lbl_8020960C
/* 80209600 00206560  38 7E 00 00 */	addi r3, r30, 0
/* 80209604 00206564  38 9D 00 00 */	addi r4, r29, 0
/* 80209608 00206568  4B FF F9 19 */	bl __CARDPutControlBlock
lbl_8020960C:
/* 8020960C 0020656C  80 1E 00 D8 */	lwz r0, 0xd8(r30)
/* 80209610 00206570  28 00 00 00 */	cmplwi r0, 0
/* 80209614 00206574  7C 0C 03 78 */	mr r12, r0
/* 80209618 00206578  41 82 00 1C */	beq lbl_80209634
/* 8020961C 0020657C  38 00 00 00 */	li r0, 0
/* 80209620 00206580  7D 88 03 A6 */	mtlr r12
/* 80209624 00206584  90 1E 00 D8 */	stw r0, 0xd8(r30)
/* 80209628 00206588  38 7F 00 00 */	addi r3, r31, 0
/* 8020962C 0020658C  38 9D 00 00 */	addi r4, r29, 0
/* 80209630 00206590  4E 80 00 21 */	blrl 
lbl_80209634:
/* 80209634 00206594  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 80209638 00206598  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 8020963C 0020659C  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 80209640 002065A0  7C 08 03 A6 */	mtlr r0
/* 80209644 002065A4  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 80209648 002065A8  38 21 00 28 */	addi r1, r1, 0x28
/* 8020964C 002065AC  4E 80 00 20 */	blr 

.global __CARDAllocBlock
__CARDAllocBlock:
/* 80209650 002065B0  7C 08 02 A6 */	mflr r0
/* 80209654 002065B4  1C E3 01 08 */	mulli r7, r3, 0x108
/* 80209658 002065B8  90 01 00 04 */	stw r0, 4(r1)
/* 8020965C 002065BC  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80209660 002065C0  3C C0 80 3D */	lis r6, __CARDBlock@ha
/* 80209664 002065C4  38 06 34 20 */	addi r0, r6, __CARDBlock@l
/* 80209668 002065C8  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 8020966C 002065CC  7D 20 3A 14 */	add r9, r0, r7
/* 80209670 002065D0  93 C1 00 18 */	stw r30, 0x18(r1)
/* 80209674 002065D4  80 09 00 00 */	lwz r0, 0(r9)
/* 80209678 002065D8  2C 00 00 00 */	cmpwi r0, 0
/* 8020967C 002065DC  40 82 00 0C */	bne lbl_80209688
/* 80209680 002065E0  38 60 FF FD */	li r3, -3
/* 80209684 002065E4  48 00 00 CC */	b lbl_80209750
lbl_80209688:
/* 80209688 002065E8  81 09 00 88 */	lwz r8, 0x88(r9)
/* 8020968C 002065EC  A0 08 00 06 */	lhz r0, 6(r8)
/* 80209690 002065F0  7C 00 20 40 */	cmplw r0, r4
/* 80209694 002065F4  40 80 00 0C */	bge lbl_802096A0
/* 80209698 002065F8  38 60 FF F7 */	li r3, -9
/* 8020969C 002065FC  48 00 00 B4 */	b lbl_80209750
lbl_802096A0:
/* 802096A0 00206600  7C 04 00 50 */	subf r0, r4, r0
/* 802096A4 00206604  B0 08 00 06 */	sth r0, 6(r8)
/* 802096A8 00206608  3C C0 00 01 */	lis r6, 0x0000FFFF@ha
/* 802096AC 0020660C  39 86 FF FF */	addi r12, r6, 0x0000FFFF@l
/* 802096B0 00206610  A1 68 00 08 */	lhz r11, 8(r8)
/* 802096B4 00206614  38 0C 00 00 */	addi r0, r12, 0
/* 802096B8 00206618  3B C0 00 00 */	li r30, 0
/* 802096BC 0020661C  48 00 00 7C */	b lbl_80209738
lbl_802096C0:
/* 802096C0 00206620  A1 49 00 10 */	lhz r10, 0x10(r9)
/* 802096C4 00206624  3B DE 00 01 */	addi r30, r30, 1
/* 802096C8 00206628  57 C6 04 3E */	clrlwi r6, r30, 0x10
/* 802096CC 0020662C  38 EA FF FB */	addi r7, r10, -5
/* 802096D0 00206630  7C 07 30 00 */	cmpw r7, r6
/* 802096D4 00206634  40 80 00 0C */	bge lbl_802096E0
/* 802096D8 00206638  38 60 FF FA */	li r3, -6
/* 802096DC 0020663C  48 00 00 74 */	b lbl_80209750
lbl_802096E0:
/* 802096E0 00206640  39 6B 00 01 */	addi r11, r11, 1
/* 802096E4 00206644  55 66 04 3E */	clrlwi r6, r11, 0x10
/* 802096E8 00206648  28 06 00 05 */	cmplwi r6, 5
/* 802096EC 0020664C  41 80 00 0C */	blt lbl_802096F8
/* 802096F0 00206650  7C 06 50 40 */	cmplw r6, r10
/* 802096F4 00206654  41 80 00 08 */	blt lbl_802096FC
lbl_802096F8:
/* 802096F8 00206658  39 60 00 05 */	li r11, 5
lbl_802096FC:
/* 802096FC 0020665C  55 66 0B FC */	rlwinm r6, r11, 1, 0xf, 0x1e
/* 80209700 00206660  7C E8 32 14 */	add r7, r8, r6
/* 80209704 00206664  A0 C7 00 00 */	lhz r6, 0(r7)
/* 80209708 00206668  28 06 00 00 */	cmplwi r6, 0
/* 8020970C 0020666C  40 82 00 2C */	bne lbl_80209738
/* 80209710 00206670  55 86 04 3E */	clrlwi r6, r12, 0x10
/* 80209714 00206674  28 06 FF FF */	cmplwi r6, 0xffff
/* 80209718 00206678  40 82 00 0C */	bne lbl_80209724
/* 8020971C 0020667C  7D 6C 5B 78 */	mr r12, r11
/* 80209720 00206680  48 00 00 0C */	b lbl_8020972C
lbl_80209724:
/* 80209724 00206684  57 E6 0B FC */	rlwinm r6, r31, 1, 0xf, 0x1e
/* 80209728 00206688  7D 68 33 2E */	sthx r11, r8, r6
lbl_8020972C:
/* 8020972C 0020668C  B0 07 00 00 */	sth r0, 0(r7)
/* 80209730 00206690  3B EB 00 00 */	addi r31, r11, 0
/* 80209734 00206694  38 84 FF FF */	addi r4, r4, -1
lbl_80209738:
/* 80209738 00206698  28 04 00 00 */	cmplwi r4, 0
/* 8020973C 0020669C  40 82 FF 84 */	bne lbl_802096C0
/* 80209740 002066A0  B1 68 00 08 */	sth r11, 8(r8)
/* 80209744 002066A4  7D 04 43 78 */	mr r4, r8
/* 80209748 002066A8  B1 89 00 BE */	sth r12, 0xbe(r9)
/* 8020974C 002066AC  48 00 00 B9 */	bl __CARDUpdateFatBlock
lbl_80209750:
/* 80209750 002066B0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80209754 002066B4  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80209758 002066B8  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 8020975C 002066BC  7C 08 03 A6 */	mtlr r0
/* 80209760 002066C0  38 21 00 20 */	addi r1, r1, 0x20
/* 80209764 002066C4  4E 80 00 20 */	blr 

.global __CARDFreeBlock
__CARDFreeBlock:
/* 80209768 002066C8  7C 08 02 A6 */	mflr r0
/* 8020976C 002066CC  1C E3 01 08 */	mulli r7, r3, 0x108
/* 80209770 002066D0  90 01 00 04 */	stw r0, 4(r1)
/* 80209774 002066D4  3C C0 80 3D */	lis r6, __CARDBlock@ha
/* 80209778 002066D8  94 21 FF F8 */	stwu r1, -8(r1)
/* 8020977C 002066DC  38 06 34 20 */	addi r0, r6, __CARDBlock@l
/* 80209780 002066E0  7D 20 3A 14 */	add r9, r0, r7
/* 80209784 002066E4  80 09 00 00 */	lwz r0, 0(r9)
/* 80209788 002066E8  2C 00 00 00 */	cmpwi r0, 0
/* 8020978C 002066EC  40 82 00 0C */	bne lbl_80209798
/* 80209790 002066F0  38 60 FF FD */	li r3, -3
/* 80209794 002066F4  48 00 00 60 */	b lbl_802097F4
lbl_80209798:
/* 80209798 002066F8  81 09 00 88 */	lwz r8, 0x88(r9)
/* 8020979C 002066FC  38 E0 00 00 */	li r7, 0
/* 802097A0 00206700  48 00 00 40 */	b lbl_802097E0
lbl_802097A4:
/* 802097A4 00206704  54 84 04 3E */	clrlwi r4, r4, 0x10
/* 802097A8 00206708  28 04 00 05 */	cmplwi r4, 5
/* 802097AC 0020670C  41 80 00 10 */	blt lbl_802097BC
/* 802097B0 00206710  A0 09 00 10 */	lhz r0, 0x10(r9)
/* 802097B4 00206714  7C 04 00 40 */	cmplw r4, r0
/* 802097B8 00206718  41 80 00 0C */	blt lbl_802097C4
lbl_802097BC:
/* 802097BC 0020671C  38 60 FF FA */	li r3, -6
/* 802097C0 00206720  48 00 00 34 */	b lbl_802097F4
lbl_802097C4:
/* 802097C4 00206724  54 80 08 3C */	slwi r0, r4, 1
/* 802097C8 00206728  7C C8 02 14 */	add r6, r8, r0
/* 802097CC 0020672C  A0 86 00 00 */	lhz r4, 0(r6)
/* 802097D0 00206730  B0 E6 00 00 */	sth r7, 0(r6)
/* 802097D4 00206734  A0 C8 00 06 */	lhz r6, 6(r8)
/* 802097D8 00206738  38 06 00 01 */	addi r0, r6, 1
/* 802097DC 0020673C  B0 08 00 06 */	sth r0, 6(r8)
lbl_802097E0:
/* 802097E0 00206740  54 80 04 3E */	clrlwi r0, r4, 0x10
/* 802097E4 00206744  28 00 FF FF */	cmplwi r0, 0xffff
/* 802097E8 00206748  40 82 FF BC */	bne lbl_802097A4
/* 802097EC 0020674C  7D 04 43 78 */	mr r4, r8
/* 802097F0 00206750  48 00 00 15 */	bl __CARDUpdateFatBlock
lbl_802097F4:
/* 802097F4 00206754  80 01 00 0C */	lwz r0, 0xc(r1)
/* 802097F8 00206758  38 21 00 08 */	addi r1, r1, 8
/* 802097FC 0020675C  7C 08 03 A6 */	mtlr r0
/* 80209800 00206760  4E 80 00 20 */	blr 

.global __CARDUpdateFatBlock
__CARDUpdateFatBlock:
/* 80209804 00206764  7C 08 02 A6 */	mflr r0
/* 80209808 00206768  90 01 00 04 */	stw r0, 4(r1)
/* 8020980C 0020676C  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 80209810 00206770  93 E1 00 24 */	stw r31, 0x24(r1)
/* 80209814 00206774  93 C1 00 20 */	stw r30, 0x20(r1)
/* 80209818 00206778  3B C5 00 00 */	addi r30, r5, 0
/* 8020981C 0020677C  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 80209820 00206780  3B A4 00 00 */	addi r29, r4, 0
/* 80209824 00206784  38 BD 00 00 */	addi r5, r29, 0
/* 80209828 00206788  93 81 00 18 */	stw r28, 0x18(r1)
/* 8020982C 0020678C  3B 83 00 00 */	addi r28, r3, 0
/* 80209830 00206790  38 DD 00 02 */	addi r6, r29, 2
/* 80209834 00206794  A0 64 00 04 */	lhz r3, 4(r4)
/* 80209838 00206798  1C 9C 01 08 */	mulli r4, r28, 0x108
/* 8020983C 0020679C  38 03 00 01 */	addi r0, r3, 1
/* 80209840 002067A0  3C 60 80 3D */	lis r3, __CARDBlock@ha
/* 80209844 002067A4  B0 1D 00 04 */	sth r0, 4(r29)
/* 80209848 002067A8  38 03 34 20 */	addi r0, r3, __CARDBlock@l
/* 8020984C 002067AC  7F E0 22 14 */	add r31, r0, r4
/* 80209850 002067B0  38 7D 00 04 */	addi r3, r29, 4
/* 80209854 002067B4  38 80 1F FC */	li r4, 0x1ffc
/* 80209858 002067B8  48 00 02 BD */	bl __CARDCheckSum
/* 8020985C 002067BC  38 7D 00 00 */	addi r3, r29, 0
/* 80209860 002067C0  38 80 20 00 */	li r4, 0x2000
/* 80209864 002067C4  4B FE D3 B9 */	bl DCStoreRange
/* 80209868 002067C8  93 DF 00 D8 */	stw r30, 0xd8(r31)
/* 8020986C 002067CC  3C 60 80 21 */	lis r3, EraseCallback@ha
/* 80209870 002067D0  38 A3 95 88 */	addi r5, r3, EraseCallback@l
/* 80209874 002067D4  80 1F 00 80 */	lwz r0, 0x80(r31)
/* 80209878 002067D8  7F 83 E3 78 */	mr r3, r28
/* 8020987C 002067DC  80 9F 00 0C */	lwz r4, 0xc(r31)
/* 80209880 002067E0  7C 00 E8 50 */	subf r0, r0, r29
/* 80209884 002067E4  54 00 9B 7E */	srwi r0, r0, 0xd
/* 80209888 002067E8  7C 84 01 D6 */	mullw r4, r4, r0
/* 8020988C 002067EC  4B FF F4 5D */	bl __CARDEraseSector
/* 80209890 002067F0  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 80209894 002067F4  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 80209898 002067F8  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 8020989C 002067FC  7C 08 03 A6 */	mtlr r0
/* 802098A0 00206800  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 802098A4 00206804  83 81 00 18 */	lwz r28, 0x18(r1)
/* 802098A8 00206808  38 21 00 28 */	addi r1, r1, 0x28
/* 802098AC 0020680C  4E 80 00 20 */	blr 
