.include "macros.inc"
.section .text, "ax"  # 0x80005560 - 0x80221F60
.global TRKLoadContext
TRKLoadContext:
/* 80220460 0021D3C0  80 03 00 00 */	lwz r0, 0(r3)
/* 80220464 0021D3C4  80 23 00 04 */	lwz r1, 4(r3)
/* 80220468 0021D3C8  80 43 00 08 */	lwz r2, 8(r3)
/* 8022046C 0021D3CC  A0 A3 01 A2 */	lhz r5, 0x1a2(r3)
/* 80220470 0021D3D0  54 A6 07 BD */	rlwinm. r6, r5, 0, 0x1e, 0x1e
/* 80220474 0021D3D4  41 82 00 14 */	beq lbl_80220488
/* 80220478 0021D3D8  54 A5 07 FA */	rlwinm r5, r5, 0, 0x1f, 0x1d
/* 8022047C 0021D3DC  B0 A3 01 A2 */	sth r5, 0x1a2(r3)
/* 80220480 0021D3E0  B8 A3 00 14 */	lmw r5, 0x14(r3)
/* 80220484 0021D3E4  48 00 00 08 */	b lbl_8022048C
lbl_80220488:
/* 80220488 0021D3E8  B9 A3 00 34 */	lmw r13, 0x34(r3)
lbl_8022048C:
/* 8022048C 0021D3EC  7C 7F 1B 78 */	mr r31, r3
/* 80220490 0021D3F0  7C 83 23 78 */	mr r3, r4
/* 80220494 0021D3F4  80 9F 00 80 */	lwz r4, 0x80(r31)
/* 80220498 0021D3F8  7C 8F F1 20 */	mtcrf 0xff, r4
/* 8022049C 0021D3FC  80 9F 00 84 */	lwz r4, 0x84(r31)
/* 802204A0 0021D400  7C 88 03 A6 */	mtlr r4
/* 802204A4 0021D404  80 9F 00 88 */	lwz r4, 0x88(r31)
/* 802204A8 0021D408  7C 89 03 A6 */	mtctr r4
/* 802204AC 0021D40C  80 9F 00 8C */	lwz r4, 0x8c(r31)
/* 802204B0 0021D410  7C 81 03 A6 */	mtxer r4
/* 802204B4 0021D414  7C 80 00 A6 */	mfmsr r4
/* 802204B8 0021D418  54 84 04 5E */	rlwinm r4, r4, 0, 0x11, 0xf
/* 802204BC 0021D41C  54 84 07 FA */	rlwinm r4, r4, 0, 0x1f, 0x1d
/* 802204C0 0021D420  7C 80 01 24 */	mtmsr r4
/* 802204C4 0021D424  7C 51 43 A6 */	mtspr 0x111, r2
/* 802204C8 0021D428  80 9F 00 0C */	lwz r4, 0xc(r31)
/* 802204CC 0021D42C  7C 92 43 A6 */	mtspr 0x112, r4
/* 802204D0 0021D430  80 9F 00 10 */	lwz r4, 0x10(r31)
/* 802204D4 0021D434  7C 93 43 A6 */	mtspr 0x113, r4
/* 802204D8 0021D438  80 5F 01 98 */	lwz r2, 0x198(r31)
/* 802204DC 0021D43C  80 9F 01 9C */	lwz r4, 0x19c(r31)
/* 802204E0 0021D440  83 FF 00 7C */	lwz r31, 0x7c(r31)
/* 802204E4 0021D444  4B FF ED 40 */	b TRKInterruptHandler

.global TRKEXICallBack
TRKEXICallBack:
/* 802204E8 0021D448  7C 08 02 A6 */	mflr r0
/* 802204EC 0021D44C  90 01 00 04 */	stw r0, 4(r1)
/* 802204F0 0021D450  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 802204F4 0021D454  93 E1 00 0C */	stw r31, 0xc(r1)
/* 802204F8 0021D458  7C 9F 23 78 */	mr r31, r4
/* 802204FC 0021D45C  4B FD B6 69 */	bl OSEnableScheduler
/* 80220500 0021D460  7F E3 FB 78 */	mr r3, r31
/* 80220504 0021D464  38 80 05 00 */	li r4, 0x500
/* 80220508 0021D468  4B FF FF 59 */	bl TRKLoadContext
/* 8022050C 0021D46C  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 80220510 0021D470  38 21 00 10 */	addi r1, r1, 0x10
/* 80220514 0021D474  80 01 00 04 */	lwz r0, 4(r1)
/* 80220518 0021D478  7C 08 03 A6 */	mtlr r0
/* 8022051C 0021D47C  4E 80 00 20 */	blr 

.global InitMetroTRKCommTable
InitMetroTRKCommTable:
/* 80220520 0021D480  7C 08 02 A6 */	mflr r0
/* 80220524 0021D484  90 01 00 04 */	stw r0, 4(r1)
/* 80220528 0021D488  94 21 FF F8 */	stwu r1, -8(r1)
/* 8022052C 0021D48C  2C 03 00 01 */	cmpwi r3, 1
/* 80220530 0021D490  40 82 00 68 */	bne lbl_80220598
/* 80220534 0021D494  48 00 1A 25 */	bl Hu_IsStub
/* 80220538 0021D498  3C A0 80 22 */	lis r5, DBInitComm@ha
/* 8022053C 0021D49C  3C 80 80 2F */	lis r4, gDBCommTable@ha
/* 80220540 0021D4A0  38 05 1A FC */	addi r0, r5, DBInitComm@l
/* 80220544 0021D4A4  38 A4 95 F0 */	addi r5, r4, gDBCommTable@l
/* 80220548 0021D4A8  3C 80 80 22 */	lis r4, DBInitInterrupts@ha
/* 8022054C 0021D4AC  90 05 00 00 */	stw r0, 0(r5)
/* 80220550 0021D4B0  38 04 1B 74 */	addi r0, r4, DBInitInterrupts@l
/* 80220554 0021D4B4  3C 80 80 22 */	lis r4, DBQueryData@ha
/* 80220558 0021D4B8  90 05 00 04 */	stw r0, 4(r5)
/* 8022055C 0021D4BC  38 04 1B C8 */	addi r0, r4, DBQueryData@l
/* 80220560 0021D4C0  3C 80 80 22 */	lis r4, DBRead@ha
/* 80220564 0021D4C4  90 05 00 08 */	stw r0, 8(r5)
/* 80220568 0021D4C8  38 04 1C 64 */	addi r0, r4, DBRead@l
/* 8022056C 0021D4CC  3C 80 80 22 */	lis r4, DBWrite@ha
/* 80220570 0021D4D0  90 05 00 0C */	stw r0, 0xc(r5)
/* 80220574 0021D4D4  38 04 1C F0 */	addi r0, r4, DBWrite@l
/* 80220578 0021D4D8  3C 80 80 22 */	lis r4, DBOpen@ha
/* 8022057C 0021D4DC  90 05 00 10 */	stw r0, 0x10(r5)
/* 80220580 0021D4E0  38 04 1F 50 */	addi r0, r4, DBOpen@l
/* 80220584 0021D4E4  3C 80 80 22 */	lis r4, DBClose@ha
/* 80220588 0021D4E8  90 05 00 14 */	stw r0, 0x14(r5)
/* 8022058C 0021D4EC  38 04 1F 54 */	addi r0, r4, DBClose@l
/* 80220590 0021D4F0  90 05 00 18 */	stw r0, 0x18(r5)
/* 80220594 0021D4F4  48 00 00 64 */	b lbl_802205F8
lbl_80220598:
/* 80220598 0021D4F8  48 00 0F 39 */	bl AMC_IsStub
/* 8022059C 0021D4FC  3C A0 80 22 */	lis r5, EXI2_Init@ha
/* 802205A0 0021D500  3C 80 80 2F */	lis r4, gDBCommTable@ha
/* 802205A4 0021D504  38 05 0E 6C */	addi r0, r5, EXI2_Init@l
/* 802205A8 0021D508  38 A4 95 F0 */	addi r5, r4, gDBCommTable@l
/* 802205AC 0021D50C  3C 80 80 22 */	lis r4, EXI2_EnableInterrupts@ha
/* 802205B0 0021D510  90 05 00 00 */	stw r0, 0(r5)
/* 802205B4 0021D514  38 04 0F 28 */	addi r0, r4, EXI2_EnableInterrupts@l
/* 802205B8 0021D518  3C 80 80 22 */	lis r4, EXI2_Poll@ha
/* 802205BC 0021D51C  90 05 00 04 */	stw r0, 4(r5)
/* 802205C0 0021D520  38 04 0F 54 */	addi r0, r4, EXI2_Poll@l
/* 802205C4 0021D524  3C 80 80 22 */	lis r4, EXI2_ReadN@ha
/* 802205C8 0021D528  90 05 00 08 */	stw r0, 8(r5)
/* 802205CC 0021D52C  38 04 10 5C */	addi r0, r4, EXI2_ReadN@l
/* 802205D0 0021D530  3C 80 80 22 */	lis r4, EXI2_WriteN@ha
/* 802205D4 0021D534  90 05 00 0C */	stw r0, 0xc(r5)
/* 802205D8 0021D538  38 04 13 18 */	addi r0, r4, EXI2_WriteN@l
/* 802205DC 0021D53C  3C 80 80 22 */	lis r4, EXI2_Reserve@ha
/* 802205E0 0021D540  90 05 00 10 */	stw r0, 0x10(r5)
/* 802205E4 0021D544  38 04 14 C8 */	addi r0, r4, EXI2_Reserve@l
/* 802205E8 0021D548  3C 80 80 22 */	lis r4, EXI2_Unreserve@ha
/* 802205EC 0021D54C  90 05 00 14 */	stw r0, 0x14(r5)
/* 802205F0 0021D550  38 04 14 CC */	addi r0, r4, EXI2_Unreserve@l
/* 802205F4 0021D554  90 05 00 18 */	stw r0, 0x18(r5)
lbl_802205F8:
/* 802205F8 0021D558  38 21 00 08 */	addi r1, r1, 8
/* 802205FC 0021D55C  80 01 00 04 */	lwz r0, 4(r1)
/* 80220600 0021D560  7C 08 03 A6 */	mtlr r0
/* 80220604 0021D564  4E 80 00 20 */	blr 

.global TRKUARTInterruptHandler
TRKUARTInterruptHandler:
/* 80220608 0021D568  4E 80 00 20 */	blr 

.global TRKInitializeIntDrivenUART
TRKInitializeIntDrivenUART:
/* 8022060C 0021D56C  7C 08 02 A6 */	mflr r0
/* 80220610 0021D570  90 01 00 04 */	stw r0, 4(r1)
/* 80220614 0021D574  94 21 FF F8 */	stwu r1, -8(r1)
/* 80220618 0021D578  3C 60 80 2F */	lis r3, gDBCommTable@ha
/* 8022061C 0021D57C  38 63 95 F0 */	addi r3, r3, gDBCommTable@l
/* 80220620 0021D580  3C 80 80 22 */	lis r4, TRKEXICallBack@ha
/* 80220624 0021D584  81 83 00 00 */	lwz r12, 0(r3)
/* 80220628 0021D588  38 84 04 E8 */	addi r4, r4, TRKEXICallBack@l
/* 8022062C 0021D58C  7C C3 33 78 */	mr r3, r6
/* 80220630 0021D590  7D 88 03 A6 */	mtlr r12
/* 80220634 0021D594  4E 80 00 21 */	blrl 
/* 80220638 0021D598  38 60 00 00 */	li r3, 0
/* 8022063C 0021D59C  38 21 00 08 */	addi r1, r1, 8
/* 80220640 0021D5A0  80 01 00 04 */	lwz r0, 4(r1)
/* 80220644 0021D5A4  7C 08 03 A6 */	mtlr r0
/* 80220648 0021D5A8  4E 80 00 20 */	blr 

.global EnableEXI2Interrupts
EnableEXI2Interrupts:
/* 8022064C 0021D5AC  7C 08 02 A6 */	mflr r0
/* 80220650 0021D5B0  90 01 00 04 */	stw r0, 4(r1)
/* 80220654 0021D5B4  94 21 FF F8 */	stwu r1, -8(r1)
/* 80220658 0021D5B8  3C 60 80 2F */	lis r3, gDBCommTable@ha
/* 8022065C 0021D5BC  38 63 95 F0 */	addi r3, r3, gDBCommTable@l
/* 80220660 0021D5C0  81 83 00 04 */	lwz r12, 4(r3)
/* 80220664 0021D5C4  7D 88 03 A6 */	mtlr r12
/* 80220668 0021D5C8  4E 80 00 21 */	blrl 
/* 8022066C 0021D5CC  38 21 00 08 */	addi r1, r1, 8
/* 80220670 0021D5D0  80 01 00 04 */	lwz r0, 4(r1)
/* 80220674 0021D5D4  7C 08 03 A6 */	mtlr r0
/* 80220678 0021D5D8  4E 80 00 20 */	blr 

.global TRKPollUART
TRKPollUART:
/* 8022067C 0021D5DC  7C 08 02 A6 */	mflr r0
/* 80220680 0021D5E0  90 01 00 04 */	stw r0, 4(r1)
/* 80220684 0021D5E4  94 21 FF F8 */	stwu r1, -8(r1)
/* 80220688 0021D5E8  3C 60 80 2F */	lis r3, gDBCommTable@ha
/* 8022068C 0021D5EC  38 63 95 F0 */	addi r3, r3, gDBCommTable@l
/* 80220690 0021D5F0  81 83 00 08 */	lwz r12, 8(r3)
/* 80220694 0021D5F4  7D 88 03 A6 */	mtlr r12
/* 80220698 0021D5F8  4E 80 00 21 */	blrl 
/* 8022069C 0021D5FC  38 21 00 08 */	addi r1, r1, 8
/* 802206A0 0021D600  80 01 00 04 */	lwz r0, 4(r1)
/* 802206A4 0021D604  7C 08 03 A6 */	mtlr r0
/* 802206A8 0021D608  4E 80 00 20 */	blr 

.global TRKReadUARTN
TRKReadUARTN:
/* 802206AC 0021D60C  7C 08 02 A6 */	mflr r0
/* 802206B0 0021D610  90 01 00 04 */	stw r0, 4(r1)
/* 802206B4 0021D614  94 21 FF F8 */	stwu r1, -8(r1)
/* 802206B8 0021D618  3C A0 80 2F */	lis r5, gDBCommTable@ha
/* 802206BC 0021D61C  38 A5 95 F0 */	addi r5, r5, gDBCommTable@l
/* 802206C0 0021D620  81 85 00 0C */	lwz r12, 0xc(r5)
/* 802206C4 0021D624  7D 88 03 A6 */	mtlr r12
/* 802206C8 0021D628  4E 80 00 21 */	blrl 
/* 802206CC 0021D62C  2C 03 00 00 */	cmpwi r3, 0
/* 802206D0 0021D630  40 82 00 0C */	bne lbl_802206DC
/* 802206D4 0021D634  38 60 00 00 */	li r3, 0
/* 802206D8 0021D638  48 00 00 08 */	b lbl_802206E0
lbl_802206DC:
/* 802206DC 0021D63C  38 60 FF FF */	li r3, -1
lbl_802206E0:
/* 802206E0 0021D640  38 21 00 08 */	addi r1, r1, 8
/* 802206E4 0021D644  80 01 00 04 */	lwz r0, 4(r1)
/* 802206E8 0021D648  7C 08 03 A6 */	mtlr r0
/* 802206EC 0021D64C  4E 80 00 20 */	blr 

.global TRKWriteUARTN
TRKWriteUARTN:
/* 802206F0 0021D650  7C 08 02 A6 */	mflr r0
/* 802206F4 0021D654  90 01 00 04 */	stw r0, 4(r1)
/* 802206F8 0021D658  94 21 FF F8 */	stwu r1, -8(r1)
/* 802206FC 0021D65C  3C A0 80 2F */	lis r5, gDBCommTable@ha
/* 80220700 0021D660  38 A5 95 F0 */	addi r5, r5, gDBCommTable@l
/* 80220704 0021D664  81 85 00 10 */	lwz r12, 0x10(r5)
/* 80220708 0021D668  7D 88 03 A6 */	mtlr r12
/* 8022070C 0021D66C  4E 80 00 21 */	blrl 
/* 80220710 0021D670  2C 03 00 00 */	cmpwi r3, 0
/* 80220714 0021D674  40 82 00 0C */	bne lbl_80220720
/* 80220718 0021D678  38 60 00 00 */	li r3, 0
/* 8022071C 0021D67C  48 00 00 08 */	b lbl_80220724
lbl_80220720:
/* 80220720 0021D680  38 60 FF FF */	li r3, -1
lbl_80220724:
/* 80220724 0021D684  38 21 00 08 */	addi r1, r1, 8
/* 80220728 0021D688  80 01 00 04 */	lwz r0, 4(r1)
/* 8022072C 0021D68C  7C 08 03 A6 */	mtlr r0
/* 80220730 0021D690  4E 80 00 20 */	blr 

.global ReserveEXI2Port
ReserveEXI2Port:
/* 80220734 0021D694  7C 08 02 A6 */	mflr r0
/* 80220738 0021D698  90 01 00 04 */	stw r0, 4(r1)
/* 8022073C 0021D69C  94 21 FF F8 */	stwu r1, -8(r1)
/* 80220740 0021D6A0  3C 60 80 2F */	lis r3, gDBCommTable@ha
/* 80220744 0021D6A4  38 63 95 F0 */	addi r3, r3, gDBCommTable@l
/* 80220748 0021D6A8  81 83 00 14 */	lwz r12, 0x14(r3)
/* 8022074C 0021D6AC  7D 88 03 A6 */	mtlr r12
/* 80220750 0021D6B0  4E 80 00 21 */	blrl 
/* 80220754 0021D6B4  38 21 00 08 */	addi r1, r1, 8
/* 80220758 0021D6B8  80 01 00 04 */	lwz r0, 4(r1)
/* 8022075C 0021D6BC  7C 08 03 A6 */	mtlr r0
/* 80220760 0021D6C0  4E 80 00 20 */	blr 

.global UnreserveEXI2Port
UnreserveEXI2Port:
/* 80220764 0021D6C4  7C 08 02 A6 */	mflr r0
/* 80220768 0021D6C8  90 01 00 04 */	stw r0, 4(r1)
/* 8022076C 0021D6CC  94 21 FF F8 */	stwu r1, -8(r1)
/* 80220770 0021D6D0  3C 60 80 2F */	lis r3, gDBCommTable@ha
/* 80220774 0021D6D4  38 63 95 F0 */	addi r3, r3, gDBCommTable@l
/* 80220778 0021D6D8  81 83 00 18 */	lwz r12, 0x18(r3)
/* 8022077C 0021D6DC  7D 88 03 A6 */	mtlr r12
/* 80220780 0021D6E0  4E 80 00 21 */	blrl 
/* 80220784 0021D6E4  38 21 00 08 */	addi r1, r1, 8
/* 80220788 0021D6E8  80 01 00 04 */	lwz r0, 4(r1)
/* 8022078C 0021D6EC  7C 08 03 A6 */	mtlr r0
/* 80220790 0021D6F0  4E 80 00 20 */	blr 

.global TRK_board_display
TRK_board_display:
/* 80220794 0021D6F4  7C 08 02 A6 */	mflr r0
/* 80220798 0021D6F8  90 01 00 04 */	stw r0, 4(r1)
/* 8022079C 0021D6FC  94 21 FF F8 */	stwu r1, -8(r1)
/* 802207A0 0021D700  4C C6 31 82 */	crclr 6
/* 802207A4 0021D704  4B FD 70 ED */	bl OSReport
/* 802207A8 0021D708  38 21 00 08 */	addi r1, r1, 8
/* 802207AC 0021D70C  80 01 00 04 */	lwz r0, 4(r1)
/* 802207B0 0021D710  7C 08 03 A6 */	mtlr r0
/* 802207B4 0021D714  4E 80 00 20 */	blr 

.section .data, "wa"  # 0x80222DC0 - 0x802E9640
.balign 8
.global gDBCommTable
gDBCommTable:
	.4byte 0x00000000
	.4byte 0x00000000
	.4byte 0x00000000
	.4byte 0x00000000
	.4byte 0x00000000
	.4byte 0x00000000
	.4byte 0x00000000
